# –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

## –®–∞–≥ 1: –ó–∞–ø—É—Å–∫
cd <directory>
docker-compose up --build

–ü–æ–¥–æ–∂–¥–∏ 30-40 —Å–µ–∫—É–Ω–¥, –ø–æ–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è.

–®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞
–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
Swagger UI: http://localhost:8000/docs
WebSocket —Ç–µ—Å—Ç: –æ—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª python-varan/client/test_websocket.html
Health check: http://localhost:8000/health

–®–∞–≥ 3: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–∞–º–µ—Ä—ã —á–µ—Ä–µ–∑ Swagger
–û—Ç–∫—Ä—ã—Ç—å http://localhost:8000/docs
–ù–∞–π—Ç–∏ POST /api/camera
–ù–∞–∂–∞—Ç—å "Try it out"
–í—Å—Ç–∞–≤–∏—Ç—å JSON:
{
     "camera_name": "TestCamera",
     "rtsp_url": "rtsp://admin:password@192.168.1.100:554/stream",
     "width": 1920,
     "height": 1080,
     "reconnect_interval": 5
   }

–ù–∞–∂–∞—Ç—å "Execute"
–®–∞–≥ 4: –ü—Ä–æ—Å–º–æ—Ç—Ä MJPEG —Å—Ç—Ä–∏–º–∞
–ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–∞–º–µ—Ä—ã –æ—Ç–∫—Ä–æ–π:
http://localhost:5000/neural_1

–û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker-compose down

---

## ‚úÖ –§–∏–Ω–∞–ª—å–Ω—ã–π —á–µ–∫–ª–∏—Å—Ç

- [ ] –°–æ–∑–¥–∞—Ç—å –≤—Å–µ Dockerfile
- [ ] –°–æ–∑–¥–∞—Ç—å docker-compose.yml
- [ ] –°–æ–∑–¥–∞—Ç—å .dockerignore —Ñ–∞–π–ª—ã
- [ ] –°–æ–∑–¥–∞—Ç—å requirements.txt –¥–ª—è Flask
- [ ] –û–±–Ω–æ–≤–∏—Ç—å config.py —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π ENV
- [ ] –°–æ–∑–¥–∞—Ç—å README.md
- [ ] –°–æ–∑–¥–∞—Ç—å QUICK_START.md
- [ ] –°–æ–∑–¥–∞—Ç—å .env.example

---

## üöÄ –ó–∞–ø—É—Å–∫ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
cd <directory>
docker-compose up --build


–¢—É—Ç–∞ –ø–æ–¥—Ä–æ–±–Ω–µ–µ:

# üöÄ Video Processing System

–°–∏—Å—Ç–µ–º–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤–∏–¥–µ–æ —Å RTSP –∫–∞–º–µ—Ä —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Flask + FastAPI + WebSocket.

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Docker >= 20.10
- Docker Compose >= 2.0
- Git

## ‚ö° –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
```bash
git clone &lt;your-repo-url&gt;
cd <directory>

2. –°–æ–∑–¥–∞–Ω–∏–µ .env —Ñ–∞–π–ª–∞
cp .env.example .env

3. –ó–∞–ø—É—Å–∫ –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã:
docker-compose up --build

–ò–ª–∏ –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ:
docker-compose up -d --build

4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞:
docker-compose ps

–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:
NAME                IMAGE               STATUS
vanya-flask         ...                 Up (healthy)
vanya-fastapi       ...                 Up (healthy)

üåê –î–æ—Å—Ç—É–ø–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
Flask Server (–ø–æ—Ä—Ç 5000)
Endpoint–û–ø–∏—Å–∞–Ω–∏–µ
http://localhost:5000/healthHealth check
http://localhost:5000/neural_1MJPEG —Å—Ç—Ä–∏–º #1
http://localhost:5000/neural_2MJPEG —Å—Ç—Ä–∏–º #2
http://localhost:5000/neural_3MJPEG —Å—Ç—Ä–∏–º #3
http://localhost:5000/api/camerasAPI –∫–∞–º–µ—Ä
http://localhost:5000/api/loadersAPI –∑–∞–≥—Ä—É–∑—á–∏–∫–æ–≤

FastAPI Server (–ø–æ—Ä—Ç 8000)
Endpoint–û–ø–∏—Å–∞–Ω–∏–µ
http://localhost:8000/Health check
http://localhost:8000/docsSwagger UI
http://localhost:8000/redocReDoc
ws://localhost:8000/wsWebSocket
http://localhost:8000/api/camerasREST API –∫–∞–º–µ—Ä
http://localhost:8000/api/loadersREST API –∑–∞–≥—Ä—É–∑—á–∏–∫–æ–≤
http://localhost:8000/api/status–û–±—â–∏–π —Å—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã

üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
1. –ü—Ä–æ–≤–µ—Ä–∫–∞ Flask —Å–µ—Ä–≤–µ—Ä–∞
curl http://localhost:5000/health

–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:
{"status": "ok", "service": "flask-server"}

2. –ü—Ä–æ–≤–µ—Ä–∫–∞ FastAPI —Å–µ—Ä–≤–µ—Ä–∞
curl http://localhost:8000/health

–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:
{
  "status": "ok",
  "services": {
    "fastapi": "ok",
    "flask": "ok"
  },
  "websocket": {
    "active_connections": 0
  }
}

3. –ü—Ä–æ–≤–µ—Ä–∫–∞ WebSocket
–û—Ç–∫—Ä–æ–π –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
file:///path/to/Vanya/python-varan/client/test_websocket.html

–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –≤ FastAPI:
http://localhost:8000/docs

4. Swagger UI
–û—Ç–∫—Ä–æ–π:
http://localhost:8000/docs

–ó–¥–µ—Å—å –º–æ–∂–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ API endpoints –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ.
üìä –õ–æ–≥–∏
–ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose logs -f

–õ–æ–≥–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
docker-compose logs -f flask-server
docker-compose logs -f fastapi-server

üõ†Ô∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
–û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º—ã
docker-compose down

–û—Å—Ç–∞–Ω–æ–≤–∫–∞ + —É–¥–∞–ª–µ–Ω–∏–µ volumes
docker-compose down -v

–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –æ–¥–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
docker-compose restart flask-server

–ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∫–æ–¥–∞
docker-compose up --build

üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
Vanya/
‚îú‚îÄ‚îÄ docker-compose.yml          # Orchestration
‚îú‚îÄ‚îÄ .env                        # Environment variables
‚îÇ
‚îú‚îÄ‚îÄ python-varan/# Flask —Å–µ—Ä–≤–µ—Ä (–æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∏–¥–µ–æ)
‚îÇ   ‚îú‚îÄ‚îÄclient/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄclient.html
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile
‚îÇ   ‚îú‚îÄ‚îÄ camera.py               # RTSP –∫–∞–º–µ—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ manager.py              # –ú–µ–Ω–µ–¥–∂–µ—Ä –∫–∞–º–µ—Ä
‚îÇ   ‚îú‚îÄ‚îÄ neural_loader.py        # –ó–∞–≥—Ä—É–∑—á–∏–∫ –¥–ª—è –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ server.py               # Flask REST API + MJPEG
‚îÇ   ‚îú‚îÄ‚îÄ main.py                 # Entry point
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ
‚îî‚îÄ‚îÄ shit/backend/               # FastAPI —Å–µ—Ä–≤–µ—Ä (API Gateway)
    ‚îú‚îÄ‚îÄ Dockerfile
    ‚îî‚îÄ‚îÄ app/
        ‚îú‚îÄ‚îÄ main.py             # Entry point
        ‚îú‚îÄ‚îÄ config.py           # –ù–∞—Å—Ç—Ä–æ–π–∫–∏
        ‚îú‚îÄ‚îÄ models/             # Pydantic –º–æ–¥–µ–ª–∏
        ‚îú‚îÄ‚îÄ routers/            # API endpoints
        ‚îî‚îÄ‚îÄ services/           # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
            ‚îú‚îÄ‚îÄ flask_client.py     # HTTP –∫–ª–∏–µ–Ω—Ç –∫ Flask
            ‚îî‚îÄ‚îÄ websocket_manager.py # WebSocket broadcast

üîß –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API
–î–æ–±–∞–≤–∏—Ç—å –∫–∞–º–µ—Ä—É
curl -X POST http://localhost:8000/api/camera \
  -H "Content-Type: application/json" \
  -d '{
    "camera_name": "Camera_1",
    "rtsp_url": "rtsp://admin:password@192.168.1.100:554/stream",
    "width": 1920,
    "height": 1080,
    "reconnect_interval": 5
  }'

–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∫–∞–º–µ—Ä
curl http://localhost:8000/api/cameras

–°–æ–∑–¥–∞—Ç—å –∑–∞–≥—Ä—É–∑—á–∏–∫
curl -X POST http://localhost:8000/api/loader \
  -H "Content-Type: application/json" \
  -d '{
    "loader_name": "Loader_1",
    "weights_path": "/models/yolov5s.rknn",
    "img_size": 1024,
    "server_endpoint": "/neural_1",
    "loader_matrix": [["Camera_1"], ["Camera_2"]]
  }'

–ó–∞–ø—É—Å—Ç–∏—Ç—å –∑–∞–≥—Ä—É–∑—á–∏–∫
curl -X POST http://localhost:8000/api/loader/Loader_1/start

–ü–æ–ª—É—á–∏—Ç—å –æ–±—â–∏–π —Å—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã
curl http://localhost:8000/api/status

üêõ Troubleshooting
–ü—Ä–æ–±–ª–µ–º–∞: Flask –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑ FastAPI
–°–∏–º–ø—Ç–æ–º:
Flask server unavailable: Connection refused

–†–µ—à–µ–Ω–∏–µ:
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ .env —É–∫–∞–∑–∞–Ω–æ:
FLASK_BASE_URL=http://flask-server:5000

–ü—Ä–æ–±–ª–µ–º–∞: –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø–∞–¥–∞–µ—Ç —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ —Å—Ç–∞—Ä—Ç–∞
–ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤:
docker-compose logs flask-server
docker-compose logs fastapi-server

–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:
–ù–µ–≤–µ—Ä–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –≤ Python –∫–æ–¥–µ
–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ requirements.txt
–ü–æ—Ä—Ç —É–∂–µ –∑–∞–Ω—è—Ç –Ω–∞ —Ö–æ—Å—Ç–µ
–ü—Ä–æ–±–ª–µ–º–∞: MJPEG —Å—Ç—Ä–∏–º –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
–ü—Ä–æ–≤–µ—Ä–∫–∞:
–ö–∞–º–µ—Ä—ã –∑–∞–ø—É—â–µ–Ω—ã?
curl http://localhost:8000/api/cameras

–ó–∞–≥—Ä—É–∑—á–∏–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç?
curl http://localhost:8000/api/loaders

–ü—Ä–æ–≤–µ—Ä—å endpoint:
curl -I http://localhost:5000/neural_1